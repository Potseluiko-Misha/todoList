{"ast":null,"code":"var _jsxFileName = \"D:\\\\todoList\\\\react-web-frontend\\\\src\\\\TodoAdd.js\",\n  _s = $RefreshSig$();\nimport { useState, useContext } from 'react';\nimport { useNavigate, Navigate } from 'react-router-dom';\nimport { baseURL, TokenContext } from './utility.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function TodoAdd() {\n  _s();\n  const [t, setT] = useState('');\n  const [d, setD] = useState('');\n  const [a, setA] = useState(undefined);\n  const [errors, setErrors] = useState({});\n  const token = useContext(TokenContext);\n  const redirect = useNavigate();\n  function handleFileChange(evt) {\n    const cFiles = evt.target.files;\n    if (cFiles.length > 0) setA(cFiles[0]);else setA(undefined);\n  }\n  async function handleFormSubmit(evt) {\n    evt.preventDefault();\n    const body = new FormData();\n    body.append('title', t);\n    body.append('desc', d);\n    if (a) body.append('addendum', a, a.name);\n    const response = await fetch(`${baseURL}`, {\n      method: 'POST',\n      body: body,\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    if (response.ok) redirect('/');else if (response.status == 406) setErrors((await response.json()).errors);else window.alert(response.status + ': ' + response.statusText);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [!token && /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 24\n    }, this), token && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0434\\u0435\\u043B\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleFormSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: t,\n          onChange: evt => {\n            setT(evt.target.value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 25\n        }, this), errors.title && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"label error\",\n            children: errors.title.msg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 58,\n            columnNumber: 34\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          onChange: evt => {\n            setD(evt.target.value);\n          },\n          children: d\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"\\u0418\\u043B\\u043B\\u044E\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"image/*\",\n          onChange: handleFileChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 25\n        }, this), errors.addendum && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"label error\",\n            children: errors.addendum.msg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 34\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"horizontal\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"submit\",\n            value: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true);\n}\n_s(TodoAdd, \"WutoUruhmwkgLo/Up1c/9jerZ9o=\", false, function () {\n  return [useNavigate];\n});\n_c = TodoAdd;\nvar _c;\n$RefreshReg$(_c, \"TodoAdd\");","map":{"version":3,"names":["useState","useContext","useNavigate","Navigate","baseURL","TokenContext","jsxDEV","_jsxDEV","Fragment","_Fragment","TodoAdd","_s","t","setT","d","setD","a","setA","undefined","errors","setErrors","token","redirect","handleFileChange","evt","cFiles","target","files","length","handleFormSubmit","preventDefault","body","FormData","append","name","response","fetch","method","headers","Authorization","ok","status","json","window","alert","statusText","children","to","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","value","onChange","title","className","msg","type","accept","addendum","_c","$RefreshReg$"],"sources":["D:/todoList/react-web-frontend/src/TodoAdd.js"],"sourcesContent":["import { useState, useContext } from 'react';\r\nimport { useNavigate, Navigate } from 'react-router-dom';\r\n\r\nimport { baseURL, TokenContext } from './utility.js';\r\n\r\nexport default function TodoAdd() {\r\n    const [t, setT] = useState('');\r\n    const [d, setD] = useState('');\r\n    const [a, setA] = useState(undefined);\r\n    const [errors, setErrors] = useState({});\r\n    const token = useContext(TokenContext);\r\n    const redirect = useNavigate();\r\n\r\n    function handleFileChange(evt) {\r\n        const cFiles = evt.target.files;\r\n        if (cFiles.length > 0)\r\n            setA(cFiles[0]);\r\n        else\r\n            setA(undefined);\r\n    }\r\n\r\n    async function handleFormSubmit(evt) {\r\n        evt.preventDefault();\r\n        const body = new FormData();\r\n        body.append('title', t);\r\n        body.append('desc', d);\r\n        if (a)\r\n            body.append('addendum', a, a.name);\r\n        const response = await fetch(`${baseURL}`, {\r\n            method: 'POST',\r\n            body: body,\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        });\r\n        if (response.ok)\r\n            redirect('/');\r\n        else if (response.status == 406)\r\n            setErrors((await response.json()).errors);\r\n        else\r\n            window.alert(response.status + ': ' +\r\n                         response.statusText);\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {!token && <Navigate to=\"/login\" />}\r\n            {token &&\r\n                <>\r\n                    <h1>Добавление дела</h1>\r\n                    <form onSubmit={handleFormSubmit}>\r\n                        <label>Заголовок</label>\r\n                        <input value={t}\r\n                               onChange={(evt) => {\r\n                                   setT(evt.target.value)}\r\n                               } />\r\n                        {errors.title &&\r\n                            <div><span className=\"label error\">\r\n                                {errors.title.msg}\r\n                            </span></div>\r\n                        }\r\n                        <label>Описание</label>\r\n                        <textarea onChange={(evt) => {\r\n                                      setD(evt.target.value)}\r\n                                  }>\r\n                                  {d}</textarea>\r\n                        <label>Иллюстрация</label>\r\n                        <input type=\"file\" accept=\"image/*\"\r\n                               onChange={handleFileChange} />\r\n                        {errors.addendum &&\r\n                            <div><span className=\"label error\">\r\n                                {errors.addendum.msg}\r\n                            </span></div>\r\n                        }\r\n                        <div className=\"horizontal\">\r\n                            <input type=\"submit\" value=\"Добавить\" />\r\n                        </div>\r\n                    </form>\r\n                </>\r\n            }\r\n        </>\r\n    );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}